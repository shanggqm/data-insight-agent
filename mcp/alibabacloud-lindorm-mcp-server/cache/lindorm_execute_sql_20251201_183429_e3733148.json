{
  "tool_name": "lindorm_execute_sql",
  "params": {
    "query": "SELECT uid, COUNT(*) AS msg_count\nFROM message \nWHERE created_at < '2025-09-28 00:00:00.000'\nGROUP BY uid\nORDER BY msg_count DESC\nLIMIT 500000"
  },
  "result": "The results of executing sql SELECT uid, COUNT(*) AS msg_count\nFROM message \nWHERE created_at < '2025-09-28 00:00:00.000'\nGROUP BY uid\nORDER BY msg_count DESC\nLIMIT 500000 is\nError executing query: 1030 (HY000): Got error LindormException from storage engine.\\n  Detailed error: java.lang.UnsupportedOperationException: The data need obtained exceeds the server limit, search index: default.message.message_idx, user limit: 500000, server limit: 50000\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.plan.DirectAggregateSearchIndexQueryPlan.getGroupByLimitForBucket(DirectAggregateSearchIndexQueryPlan.java:381)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.plan.DirectAggregateSearchIndexQueryPlan.setAggregateQuery(DirectAggregateSearchIndexQueryPlan.java:98)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.plan.DirectAggregateSearchIndexQueryPlan.<init>(DirectAggregateSearchIndexQueryPlan.java:92)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.AggregateCompiler.createSearchIndexQueryPlan(AggregateCompiler.java:410)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.AggregateCompilerV2.createSearchIndexQueryPlan(AggregateCompilerV2.java:303)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.AggregateCompilerV2.createSearchIndexQueryPlan(AggregateCompilerV2.java:81)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.QueryCompiler.compile(QueryCompiler.java:337)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.AggregateCompilerV2.compile(AggregateCompilerV2.java:93)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.compile.AggregateCompilerV2.compile(AggregateCompilerV2.java:81)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.QueryProcessor.doAggregate(QueryProcessor.java:3866)\n\tat com.alibaba.lindorm.server.ldserver.queryprocessor.QueryProcessor.selectV2(QueryProcessor.java:3917)\n\tat com.alibaba.lindorm.server.ldserver.LDServer.selectV2(LDServer.java:10700)\n\tat com.alibaba.lindorm.server.acl.ACLProtocolProxy.selectV2(ACLProtocolProxy.java:851)\n\tat sun.reflect.GeneratedMethodAccessor147.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat com.alibaba.lindorm.server.ipc.WritableRpcEngine$Server.call(WritableRpcEngine.java:441)\n\t... 1 more\n\n\tat sun.reflect.GeneratedConstructorAccessor127.newInstance(Unknown Source)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat com.alibaba.lindorm.server.RemoteExceptionUtil.unwrapRemoteExceptionClean(RemoteExceptionUtil.java:20)\n\tat com.alibaba.lindorm.server.sqlserver.service.ShortCircuitResponder.handleResult(ShortCircuitResponder.java:94)\n\tat com.alibaba.lindorm.server.sqlserver.service.ShortCircuitResponder.getResult(ShortCircuitResponder.java:143)\n\tat com.alibaba.lindorm.server.sqlserver.service.ShortCircuitACLProxy.invoke(ShortCircuitACLProxy.java:79)\n\tat com.sun.proxy.$Proxy39.selectV2(Unknown Source)\n\tat com.alibaba.lindorm.client.core.tableservice.LSelectV2$2.call(LSelectV2.java:660)\n\tat com.alibaba.lindorm.client.core.tableservice.LSelectV2$2.call(LSelectV2.java:657)\n\tat com.alibaba.lindorm.client.core.ipc.RetryingCaller.call(RetryingCaller.java:121)\n\tat com.alibaba.lindorm.client.core.ipc.RetryingCaller.withRetries(RetryingCaller.java:355)\n\tat com.alibaba.lindorm.client.core.tableservice.LSelect.next(LSelect.java:1425)\n\tat com.alibaba.lindorm.client.core.tableservice.LQueryResults.loadCache(LQueryResults.java:264)\n\tat com.alibaba.lindorm.client.core.tableservice.LQueryResults.next(LQueryResults.java:116)\n\tat com.alibaba.lindorm.client.core.tableservice.LQueryResults$1.hasNext(LQueryResults.java:81)\n\tat com.alibaba.lindorm.sql.enumerator.TimedIterator.hasNext(TimedIterator.java:41)\n\tat com.alibaba.lindorm.sql.enumerator.SimpleEnumerator.doMoveNext(SimpleEnumerator.java:55)\n\tat com.alibaba.lindorm.sql.enumerator.InputStatisticalEnumerator.moveNext(InputStatisticalEnumerator.java:72)\n\tat com.alibaba.lindorm.sql.jdbc.DelegateQueryEnumerator.moveNext(DelegateQueryEnumerator.java:85)\n\tat org.apache.calcite.linq4j.DelegatingEnumerator.moveNext(DelegatingEnumerator.java:36)\n\tat com.alibaba.lindorm.sql.metrics.EnumeratorWithMetric.moveNext(EnumeratorWithMetric.java:45)\n\tat com.alibaba.lindorm.sql.mysql.execution.query.text.query.QueryProxy.next(QueryProxy.java:105)\n\tat com.alibaba.lindorm.sql.mysql.execution.query.text.query.MySQLComQueryPacketExecutor.doNext(MySQLComQueryPacketExecutor.java:108)\n\tat com.alibaba.lindorm.sql.mysql.execution.executor.QueryCommandExecutor.next(QueryCommandExecutor.java:54)\n\tat com.alibaba.lindorm.sql.mysql.execution.MySQLCommandExecuteEngine.writeQueryData(MySQLCommandExecuteEngine.java:115)\n\tat com.alibaba.lindorm.sql.mysql.execution.executor.CommandExecutorTask.executeCommand(CommandExecutorTask.java:156)\n\tat com.alibaba.lindorm.sql.mysql.execution.executor.CommandExecutorTask.run(CommandExecutorTask.java:99)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1152)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:627)\n\tat java.lang.Thread.run(Thread.java:882)",
  "cached_at": "2025-12-01T18:34:29.853717"
}